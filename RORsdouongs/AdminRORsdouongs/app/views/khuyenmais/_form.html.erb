<%@sanphams = Sanpham.all%>
<div class="main-header">
    <div class="mobile-toggle" id="mobile-toggle">
        <i class='bx bx-menu-alt-right'></i>
    </div>
    <div class="main-title">
        Thêm khuyến mãi
    </div>
</div>
<div class="main-content">
    <div class="box">
        <div class="box-body overflow-scroll">
            <%= form_with(model: khuyenmai) do |form| %>
            <div class="container-fluid">
                <div class="row">

                    <div class="col-md-8"><div class="form">
                        
                        <% if khuyenmai.errors.any? %>
                        <div id="error_explanation">
                          <h2><%= pluralize(khuyenmai.errors.count, "error") %> prohibited this dathang from being saved:</h2>

                          <ul>
                            <% khuyenmai.errors.each do |error| %>
                              <li><%= error.full_message %></li>
                            <% end %>
                          </ul>
                        </div>
                      <% end %>
                            <h3 class="name">Khuyến mãi</h3>
                         
                            <%= form.text_field :tendot, class: 'promation-name', placeholder: 'Tên khuyến Mãi' %>
                            <div id="time">
                                <h3 class="name">Thời gian</h3>
                                <% datet = DateTime.now.year.to_s+"-"+DateTime.now.month.to_s+"-"+(DateTime.now.day+1).to_s %>
                                <input type="date" class="startdate" name="start_date" min="<%= datet%>" value="<%= datet%>" ><br>
                                <label for="start_name" class="startlabel">Ngày bắt đầu</label>
                                <input type="date" class="enddate" name="end_date" min="<%= datet%>" value="<%= datet%>" >
                                <label for="end_name" class="endlabel">Ngày kết thúc</label>
                            </div>
                            
                            <h4 class="name">Mức giảm (%)</h4>
                            <input type="number" class="startdate" name="tylegiam" value="1" min="0" max="100">
                            <h3 class="name">Quà tặng</h3>
                            <% datet = DateTime.now.year.to_s+"-"+DateTime.now.month.to_s+"-"+(DateTime.now.day+1).to_s %>
                            <h4 class="startdate">Số lượng mua</h4>
                            <input type="number" class="enddate" name="soluongmua" value="0" min="0" max="100" >
                             <h4 class="startdate">số lượng tặng</h4>
                            <input type="number"  class="enddate" name="soluongtang" value="0" min="0" max="100" ><br/>
                           
                            <button type="submit">Submit</button>
                     
                    </div></div>
                    <div class="col-md-4">
                        <div class="box f-height">
                            <div class="box-header">
                               Sản phẩm khuyến mãi
                            </div>
                            <div class="box-body">
                                
                                   <%counter = 1%>
                                <% @sanphams.each do |chonthem| %>
                                     
                                    <% chonthemcb = "subchecked[#{counter.to_s}]"%>
                                     <div>
                                    <h4>
                                        <%= check_box_tag(chonthemcb, chonthem.id)%>
                                        <%= label_tag(chonthemcb, chonthem.tensanpham) %>
                                    </h4></div>
                                    <% counter = counter + 1%>
                                   
                                <% end %>
                            </div>
                        </div>
                    </div>
                </div>
            </div>   <% end%>
            
        </div>
    </div>
</div> 
<script type="text/javascript">
   
    $(function savespham(){
        var lick = 0;
        $('.nice-select').trigger('change'); //This event will fire the change event. 
        $('.nice-select').change(function(){  
          var data= $(this).val();
          lick = lick + 1;
          var tr = "sanphamkm" + lick; 
          document.getElementById(tr).value=data;

        });   
        
    });

</script>
